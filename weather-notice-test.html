<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚ ì”¨ ê¸°ë°˜ Notice í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .weather-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .notice-card {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border-left: 4px solid #2196F3;
        }
        
        .notice-card.priority-1 {
            border-left-color: #f44336;
            background-color: #ffebee;
        }
        
        .notice-card.priority-2 {
            border-left-color: #ff9800;
            background-color: #fff3e0;
        }
        
        .notice-card.priority-3 {
            border-left-color: #4caf50;
            background-color: #e8f5e8;
        }
        
        .notice-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .notice-content {
            font-size: 14px;
            line-height: 1.6;
            color: #555;
        }
        
        .notice-meta {
            font-size: 12px;
            color: #888;
            margin-top: 10px;
            display: flex;
            justify-content: space-between;
        }
        
        .priority-badge {
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
        }
        
        .priority-1 .priority-badge {
            background: #f44336;
            color: white;
        }
        
        .priority-2 .priority-badge {
            background: #ff9800;
            color: white;
        }
        
        .priority-3 .priority-badge {
            background: #4caf50;
            color: white;
        }
        
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        
        button:hover {
            background: #1976D2;
        }
        
        .loading {
            text-align: center;
            color: #666;
        }
        
        .error {
            background: #ffebee;
            color: #c62828;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸŒ¤ï¸ ë‚ ì”¨ ê¸°ë°˜ ê³µì§€ì‚¬í•­ ìƒì„± ì‹œìŠ¤í…œ</h1>
        
        <div>
            <h3>í…ŒìŠ¤íŠ¸ ìœ„ì¹˜</h3>
            <button onclick="testLocation(37.5665, 126.9780, 'ì„œìš¸ì‹œì²­')">ì„œìš¸ì‹œì²­</button>
            <button onclick="testLocation(35.1595, 129.0596, 'ë¶€ì‚°ì‹œì²­')">ë¶€ì‚°ì‹œì²­</button>
            <button onclick="testLocation(35.8714, 128.6014, 'ëŒ€êµ¬ì‹œì²­')">ëŒ€êµ¬ì‹œì²­</button>
            <button onclick="testDummyWeather()">ë”ë¯¸ ë°ì´í„° í…ŒìŠ¤íŠ¸</button>
        </div>
        
        <div id="result"></div>
    </div>

    <script>
        const API_URL = 'https://your-supabase-project.supabase.co/functions/v1/get-weather-by-grid';
        
        async function testLocation(lat, lng, name) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="loading">ë‚ ì”¨ ë°ì´í„°ì™€ ê³µì§€ì‚¬í•­ì„ ìƒì„± ì¤‘...</div>';
            
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        lat: lat,
                        lng: lng,
                        address: name
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    displayResult(data.weather, name);
                } else {
                    resultDiv.innerHTML = `<div class="error">ì˜¤ë¥˜: ${data.error}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}</div>`;
            }
        }
        
        function testDummyWeather() {
            // ë‹¤ì–‘í•œ ë”ë¯¸ ë‚ ì”¨ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸
            const dummyScenarios = [
                {
                    name: "ê·¹í•œ í­ì—¼ + ê³ ìŠµë„",
                    weather: {
                        temperature: 38,
                        humidity: 90,
                        precipitation: 0,
                        windSpeed: 3,
                        skyCondition: 'clear',
                        skyDescription: 'ë§‘ìŒ',
                        precipitationType: 'none',
                        precipitationDescription: 'ì—†ìŒ',
                        notices: []
                    }
                },
                {
                    name: "í•œíŒŒ + ê°•í’ + ëˆˆ",
                    weather: {
                        temperature: -5,
                        humidity: 70,
                        precipitation: 8,
                        windSpeed: 15,
                        skyCondition: 'snowy',
                        skyDescription: 'ëˆˆ',
                        precipitationType: 'snow',
                        precipitationDescription: 'ëˆˆ',
                        notices: []
                    }
                },
                {
                    name: "ì§‘ì¤‘í˜¸ìš° + ê°•í’",
                    weather: {
                        temperature: 25,
                        humidity: 95,
                        precipitation: 35,
                        windSpeed: 12,
                        skyCondition: 'rainy',
                        skyDescription: 'ë¹„',
                        precipitationType: 'rain',
                        precipitationDescription: 'ë¹„',
                        notices: []
                    }
                },
                {
                    name: "ì™„ë²½í•œ ë‚ ì”¨",
                    weather: {
                        temperature: 22,
                        humidity: 55,
                        precipitation: 0,
                        windSpeed: 2,
                        skyCondition: 'clear',
                        skyDescription: 'ë§‘ìŒ',
                        precipitationType: 'none',
                        precipitationDescription: 'ì—†ìŒ',
                        notices: []
                    }
                }
            ];
            
            // ëœë¤ìœ¼ë¡œ ì‹œë‚˜ë¦¬ì˜¤ ì„ íƒ
            const randomScenario = dummyScenarios[Math.floor(Math.random() * dummyScenarios.length)];
            
            // Notice ìƒì„± ì‹œë®¬ë ˆì´ì…˜ (ì‹¤ì œë¡œëŠ” APIì—ì„œ ìƒì„±ë¨)
            const mockNotices = generateMockNotices(randomScenario.weather);
            randomScenario.weather.notices = mockNotices;
            
            // ë”ë¯¸ ë°ì´í„° ì¶”ê°€
            randomScenario.weather.date = new Date().toISOString().split('T')[0];
            randomScenario.weather.time = new Date().getHours().toString().padStart(2, '0') + '00';
            randomScenario.weather.gridX = 60;
            randomScenario.weather.gridY = 127;
            randomScenario.weather.address = `í…ŒìŠ¤íŠ¸ ì§€ì—­ (${randomScenario.name})`;
            
            displayResult(randomScenario.weather, randomScenario.name);
        }
        
        // Mock Notice ìƒì„± í•¨ìˆ˜ (ì‹¤ì œ weather-notices.ts ë¡œì§ ì‹œë®¬ë ˆì´ì…˜)
        function generateMockNotices(weather) {
            const notices = [];
            const mockNoticesDB = {
                hot: [
                    {
                        title: "í­ì—¼ ê²½ë³´ - ì•¼ì™¸í™œë™ ì „ë©´ ê¸ˆì§€",
                        content: "ê¸°ìƒì²­ì—ì„œ í­ì—¼ ê²½ë³´ë¥¼ ë°œë ¹í–ˆìŠµë‹ˆë‹¤. ëª¨ë“  ì•¼ì™¸ ìˆ˜ì—…ê³¼ í™œë™ì„ ì¤‘ë‹¨í•˜ê³  ì‹¤ë‚´ì—ì„œ ì§„í–‰í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.",
                        category: "ì•ˆì „", priority: 1, icon: "ğŸš¨"
                    },
                    {
                        title: "ë¬´ë”ìœ„ ëŒ€ë¹„ í•™ìƒ ê±´ê°•ê´€ë¦¬ í˜‘ì¡° ìš”ì²­",
                        content: "ì—°ì¼ ê³„ì†ë˜ëŠ” ë¬´ë”ìœ„ë¡œ í•™ìƒë“¤ì˜ ì»¨ë””ì…˜ ë‚œì¡°ê°€ ìš°ë ¤ë©ë‹ˆë‹¤. êµì‹¤ ì˜¨ë„ ì²´í¬ë¥¼ ìì£¼ í•´ì£¼ì‹œê³ , í•™ìƒë“¤ì´ ì–´ì§€ëŸ¬ì›€ì´ë‚˜ ë©”ìŠ¤êº¼ì›€ì„ í˜¸ì†Œí•  ê²½ìš° ì¦‰ì‹œ ë³´ê±´ì‹¤ë¡œ ì•ˆë‚´í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.",
                        category: "ê±´ê°•", priority: 1, icon: "ğŸ¥"
                    }
                ],
                cold: [
                    {
                        title: "í•œíŒŒ ê²½ë³´ - ì‹¤ì™¸ í™œë™ ì „ë©´ ì¤‘ë‹¨",
                        content: "ê¸°ìƒì²­ì—ì„œ í•œíŒŒ ê²½ë³´ë¥¼ ë°œë ¹í–ˆìŠµë‹ˆë‹¤. ëª¨ë“  ì‹¤ì™¸ ìˆ˜ì—…ê³¼ í™œë™ì„ ì¤‘ë‹¨í•˜ê³  ì‹¤ë‚´ì—ì„œë§Œ ì§„í–‰í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.",
                        category: "ì•ˆì „", priority: 1, icon: "â„ï¸"
                    }
                ],
                heavy_rain: [
                    {
                        title: "ì§‘ì¤‘í˜¸ìš° ê²½ë³´ - ì¹¨ìˆ˜ ì§€ì—­ ìš°íšŒ ì•ˆë‚´",
                        content: "ì‹œê°„ë‹¹ 20mm ì´ìƒì˜ í­ìš°ê°€ ë‚´ë¦¬ê³  ìˆìŠµë‹ˆë‹¤. í•™êµ ì£¼ë³€ ì¹¨ìˆ˜ ìœ„í—˜ ì§€ì—­ì„ íŒŒì•…í•˜ì‹œê³ , ì•ˆì „í•œ ë“±í•˜êµ ê²½ë¡œë¥¼ í•™ìƒë“¤ì—ê²Œ ì•ˆë‚´í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.",
                        category: "ì•ˆì „", priority: 1, icon: "ğŸŒŠ"
                    }
                ],
                rain: [
                    {
                        title: "ìš°ì²œ ì‹œ ìš°ì‚° ì§€ì°¸ ë° ì•ˆì „ ê·€ê°€ ì§€ë„",
                        content: "ì˜¤ëŠ˜ í•˜ë£¨ ì¢…ì¼ ë¹„ê°€ ì˜ˆìƒë©ë‹ˆë‹¤. í•™ìƒë“¤ì´ ìš°ì‚°ì„ ì¤€ë¹„í–ˆëŠ”ì§€ í™•ì¸í•´ ì£¼ì‹œê³ , í•˜êµ ì‹œ ë¯¸ë„ëŸ¬ìš´ ê¸¸ë©´ì—ì„œì˜ ì•ˆì „ì‚¬ê³  ì˜ˆë°©ì„ ìœ„í•œ ì£¼ì˜ì‚¬í•­ì„ ë‹¹ë¶€í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.",
                        category: "ì•ˆì „", priority: 2, icon: "â˜”"
                    }
                ],
                snow: [
                    {
                        title: "ëŒ€ì„¤ ì£¼ì˜ë³´ - êµë‚´ ë¹™íŒê¸¸ ì•ˆì „ì‚¬ê³  ì˜ˆë°©",
                        content: "ëˆˆì´ ë‚´ë ¤ êµë‚´ì— ë¹™íŒê¸¸ì´ í˜•ì„±ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•™ìƒë“¤ì—ê²Œ ì²œì²œíˆ ê±·ê¸°ë¥¼ ì§€ë„í•´ ì£¼ì‹œê³ , ê³„ë‹¨ì´ë‚˜ ê²½ì‚¬ë¡œì—ì„œëŠ” íŠ¹íˆ ì£¼ì˜í•˜ë„ë¡ ì•ˆë‚´í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.",
                        category: "ì•ˆì „", priority: 1, icon: "â›„"
                    }
                ],
                wind: [
                    {
                        title: "ê°•í’ ì£¼ì˜ë³´ - ì•¼ì™¸í™œë™ ì „ë©´ ê¸ˆì§€",
                        content: "í’ì† 10m/s ì´ìƒì˜ ê°•í’ì´ ì˜ˆìƒë©ë‹ˆë‹¤. ëª¨ë“  ì•¼ì™¸í™œë™ì„ ì¤‘ë‹¨í•˜ê³  ì‹¤ë‚´ë¡œ ëŒ€í”¼ì‹œì¼œ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.",
                        category: "ì•ˆì „", priority: 1, icon: "ğŸ’¨"
                    }
                ],
                humid: [
                    {
                        title: "ê³ ìŠµë„ ì£¼ì˜ - êµì‹¤ ì œìŠµ ë° í™˜ê¸° ê´€ë¦¬",
                        content: "ìŠµë„ê°€ 80% ì´ìƒìœ¼ë¡œ ë§¤ìš° ë†’ìŠµë‹ˆë‹¤. ì œìŠµê¸°ë¥¼ ê°€ë™í•˜ê³  ìì£¼ í™˜ê¸°ë¥¼ ì‹¤ì‹œí•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.",
                        category: "ìƒí™œ", priority: 2, icon: "ğŸ’§"
                    }
                ],
                normal: [
                    {
                        title: "ì¾Œì í•œ ë‚ ì”¨ - ì•¼ì™¸ êµìœ¡í™œë™ ì¶”ì²œ",
                        content: "ì˜¤ëŠ˜ì€ ì•¼ì™¸í™œë™í•˜ê¸° ì¢‹ì€ ë‚ ì”¨ì…ë‹ˆë‹¤. ìì—° ê´€ì°°, ìš´ë™ì¥ ì²´ìœ¡í™œë™, ì‚°ì±… ë“±ì„ í†µí•´ í•™ìƒë“¤ì´ ìì—°ê³¼ í•¨ê»˜í•  ìˆ˜ ìˆëŠ” ì‹œê°„ì„ ê°€ì ¸ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤.",
                        category: "í•™êµí™œë™", priority: 3, icon: "ğŸŒ¤ï¸"
                    }
                ]
            };
            
            const today = new Date().toISOString().split('T')[0];
            
            // ì˜¨ë„ ì¡°ê±´
            if (weather.temperature >= 35) {
                notices.push(...mockNoticesDB.hot.map(n => ({...n, date: today})));
            } else if (weather.temperature <= 0) {
                notices.push(...mockNoticesDB.cold.map(n => ({...n, date: today})));
            }
            
            // ê°•ìˆ˜ ì¡°ê±´
            if (weather.precipitation >= 20) {
                notices.push(...mockNoticesDB.heavy_rain.map(n => ({...n, date: today})));
            } else if (weather.precipitation > 0) {
                if (weather.precipitationType === 'snow') {
                    notices.push(...mockNoticesDB.snow.map(n => ({...n, date: today})));
                } else {
                    notices.push(...mockNoticesDB.rain.map(n => ({...n, date: today})));
                }
            }
            
            // í’ì† ì¡°ê±´
            if (weather.windSpeed >= 10) {
                notices.push(...mockNoticesDB.wind.map(n => ({...n, date: today})));
            }
            
            // ìŠµë„ ì¡°ê±´
            if (weather.humidity >= 85) {
                notices.push(...mockNoticesDB.humid.map(n => ({...n, date: today})));
            }
            
            // íŠ¹ë³„í•œ ì¡°ê±´ì´ ì—†ìœ¼ë©´ ì¼ë°˜ ë‚ ì”¨
            if (notices.length === 0) {
                notices.push(...mockNoticesDB.normal.map(n => ({...n, date: today})));
            }
            
            // ìµœëŒ€ 3ê°œê¹Œì§€, ìš°ì„ ìˆœìœ„ ìˆœ ì •ë ¬
            return notices.slice(0, 3).sort((a, b) => a.priority - b.priority);
        }
        
        function displayResult(weather, location) {
            const resultDiv = document.getElementById('result');
            
            const priorityText = {
                1: 'ê¸´ê¸‰',
                2: 'ì£¼ì˜',
                3: 'ì •ë³´'
            };
            
            let html = `
                <div class="weather-info">
                    <h3>ğŸ“ ${location} í˜„ì¬ ë‚ ì”¨</h3>
                    <p><strong>ì˜¨ë„:</strong> ${weather.temperature}Â°C</p>
                    <p><strong>ìŠµë„:</strong> ${weather.humidity}%</p>
                    <p><strong>ê°•ìˆ˜ëŸ‰:</strong> ${weather.precipitation}mm</p>
                    <p><strong>í’ì†:</strong> ${weather.windSpeed}m/s</p>
                    <p><strong>ë‚ ì”¨:</strong> ${weather.skyDescription}</p>
                    <p><strong>ê°•ìˆ˜í˜•íƒœ:</strong> ${weather.precipitationDescription}</p>
                </div>
                
                <h3>ğŸ“‹ ìƒì„±ëœ ê³µì§€ì‚¬í•­</h3>
            `;
            
            if (weather.notices && weather.notices.length > 0) {
                weather.notices.forEach(notice => {
                    html += `
                        <div class="notice-card priority-${notice.priority}">
                            <div class="notice-title">
                                <span>${notice.icon}</span>
                                <span>${notice.title}</span>
                            </div>
                            <div class="notice-content">
                                ${notice.content}
                            </div>
                            <div class="notice-meta">
                                <span>ì¹´í…Œê³ ë¦¬: ${notice.category}</span>
                                <span class="priority-badge">${priorityText[notice.priority]}</span>
                            </div>
                        </div>
                    `;
                });
            } else {
                html += '<p>ìƒì„±ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
            }
            
            resultDiv.innerHTML = html;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë”ë¯¸ ë°ì´í„°ë¡œ ì˜ˆì‹œ ë³´ì—¬ì£¼ê¸°
        window.onload = function() {
            testDummyWeather();
        };
    </script>
</body>
</html>
