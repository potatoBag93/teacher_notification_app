<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>칠판 알림장 에디터</title>
    
    <!-- Quill stylesheet -->
    <link href="https://cdn.jsdelivr.net/npm/quill@2/dist/quill.snow.css" rel="stylesheet" />
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            min-height: 100vh;
            padding: 2rem;
            color: #ecf0f1;
        }

        .chalkboard-container {
            max-width: 1200px;
            margin: 0 auto;
            background: linear-gradient(135deg, #1e3a2e 0%, #2d5a3d 100%);
            border-radius: 2rem;
            box-shadow: 
                0 0 0 12px #34495e,
                0 0 0 16px #2c3e50,
                inset 0 0 30px rgba(0, 0, 0, 0.2),
                0 30px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            position: relative;
        }

        /* 칠판 텍스처 */
        .chalkboard-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(255, 255, 255, 0.02) 1px, transparent 1px),
                radial-gradient(circle at 70% 80%, rgba(255, 255, 255, 0.02) 1px, transparent 1px);
            pointer-events: none;
            z-index: 1;
        }

        .header {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
            padding: 2rem;
            border-bottom: 4px solid #1a252f;
            position: relative;
            z-index: 2;
        }

        .header-title {
            color: #ecf0f1;
            font-size: 2rem;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            text-align: center;
            margin-bottom: 1rem;
        }

        .toolbar {
            display: flex;
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .chalk-btn {
            background: rgba(236, 240, 241, 0.1);
            border: 2px solid #ecf0f1;
            color: #ecf0f1;
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: inherit;
            font-weight: 500;
        }

        .chalk-btn:hover {
            background: rgba(236, 240, 241, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .content {
            padding: 3rem;
            position: relative;
            z-index: 2;
        }

        .date-section {
            text-align: center;
            margin-bottom: 2rem;
        }

        .date-input {
            background: transparent;
            border: none;
            color: #ecf0f1;
            font-size: 2.5rem;
            font-weight: 700;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            font-family: 'Segoe UI', sans-serif;
            outline: none;
            width: 100%;
            padding: 1rem;
        }

        .title-section {
            margin-bottom: 1rem;
        }

        .title-input {
            background: transparent;
            border: none;
            color: #ecf0f1;
            font-size: 2rem;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            font-family: 'Segoe UI', sans-serif;
            outline: none;
            width: 100%;
            padding: 1rem 0;
        }

        /* Quill 에디터 칠판 스타일 - 더 명확한 구분 */
        .editor-wrapper {
            background: transparent;
            border: none;
            border-radius: 1rem;
            overflow: hidden;
            box-shadow: 
                0 0 0 3px #ecf0f1,
                0 8px 25px rgba(0, 0, 0, 0.3);
            margin-top: 1rem;
        }

        /* Quill 툴바 스타일 - 더 명확하게 개선 */
        #toolbar {
            background: rgba(255, 255, 255, 0.95) !important;
            border: 3px solid rgba(52, 73, 94, 0.3) !important;
            border-bottom: 3px solid rgba(52, 73, 94, 0.3) !important;
            padding: 1.5rem !important;
            border-radius: 1rem 1rem 0 0 !important;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2) !important;
            backdrop-filter: blur(10px) !important;
        }

        #toolbar .ql-formats {
            margin-right: 1rem !important;
            display: inline-flex !important;
            align-items: center !important;
            gap: 0.5rem !important;
            position: relative !important;
        }

        #toolbar .ql-formats:not(:last-child)::after {
            content: '';
            position: absolute;
            right: -0.5rem;
            top: 50%;
            transform: translateY(-50%);
            width: 1px;
            height: 24px;
            background: rgba(52, 73, 94, 0.2);
            border-radius: 1px;
        }

        #toolbar button {
            background: rgba(52, 73, 94, 0.1) !important;
            border: 2px solid rgba(52, 73, 94, 0.3) !important;
            color: #2c3e50 !important;
            border-radius: 0.5rem !important;
            margin: 0.25rem !important;
            padding: 0.6rem !important;
            transition: all 0.3s ease !important;
            min-width: 36px !important;
            min-height: 36px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            font-weight: 600 !important;
            font-size: 0.9rem !important;
            box-shadow: 0 1px 4px rgba(52, 73, 94, 0.15) !important;
        }

        #toolbar button:hover,
        #toolbar button.ql-active {
            background: rgba(52, 73, 94, 0.2) !important;
            border-color: #34495e !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 16px rgba(52, 73, 94, 0.25) !important;
            color: #2c3e50 !important;
        }

        #toolbar button svg {
            fill: #2c3e50 !important;
            stroke: #2c3e50 !important;
            width: 16px !important;
            height: 16px !important;
        }

        #toolbar button:hover svg,
        #toolbar button.ql-active svg {
            fill: #2c3e50 !important;
            stroke: #2c3e50 !important;
        }

        /* 드롭다운 선택자 스타일 개선 - 버튼과 통일성 */
        #toolbar select {
            background: rgba(52, 73, 94, 0.1) !important;
            border: 2px solid rgba(52, 73, 94, 0.3) !important;
            color: #2c3e50 !important;
            border-radius: 0.5rem !important;
            padding: 0.6rem 0.8rem !important;
            margin: 0.25rem !important;
            font-size: 0.85rem !important;
            font-weight: 600 !important;
            min-width: 70px !important;
            height: 36px !important;
            box-shadow: 0 1px 4px rgba(52, 73, 94, 0.15) !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            appearance: none !important;
            -webkit-appearance: none !important;
            -moz-appearance: none !important;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%232c3e50' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e") !important;
            background-repeat: no-repeat !important;
            background-position: right 0.7rem center !important;
            background-size: 0.65rem !important;
            padding-right: 2rem !important;
        }

        #toolbar select:hover {
            background: rgba(52, 73, 94, 0.2) !important;
            border-color: #34495e !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 16px rgba(52, 73, 94, 0.25) !important;
        }

        #toolbar select:focus {
            outline: none !important;
            border-color: #3498db !important;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2) !important;
        }

        /* 이모지 버튼 스타일 */
        .emoji-btn {
            background: none;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.5rem;
            font-size: 1.2rem;
            padding: 0.5rem;
            margin: 0 0.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .emoji-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
            border-color: rgba(255, 255, 255, 0.4);
        }

        .emoji-btn:active {
            transform: scale(0.95);
        }

        #toolbar select option {
            background: #ffffff !important;
            color: #2c3e50 !important;
            padding: 0.5rem !important;
        }

        /* 색상 드롭다운 특별 스타일 - 버튼과 통일성 */
        #toolbar .ql-color .ql-picker-label,
        #toolbar .ql-background .ql-picker-label {
            border: 2px solid rgba(52, 73, 94, 0.3) !important;
            border-radius: 0.5rem !important;
            padding: 0.6rem !important;
            background: rgba(52, 73, 94, 0.1) !important;
            min-width: 36px !important;
            min-height: 36px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            margin: 0.25rem !important;
            transition: all 0.3s ease !important;
            box-shadow: 0 1px 4px rgba(52, 73, 94, 0.15) !important;
        }

        #toolbar .ql-color .ql-picker-label:hover,
        #toolbar .ql-background .ql-picker-label:hover {
            background: rgba(52, 73, 94, 0.2) !important;
            border-color: #34495e !important;
            transform: translateY(-2px) !important;
            box-shadow: 0 4px 16px rgba(52, 73, 94, 0.25) !important;
        }

        /* 색상 피커 드롭다운 화살표 추가 */
        #toolbar .ql-color .ql-picker-label::after,
        #toolbar .ql-background .ql-picker-label::after {
            content: '▼';
            font-size: 8px;
            color: #2c3e50;
            position: absolute;
            right: 4px;
            bottom: 2px;
        }

        /* Quill 에디터 영역 - 더 명확한 구분 */
        #editor {
            background: rgba(30, 58, 46, 0.4) !important;
            color: #ecf0f1 !important;
            font-size: 1.4rem !important;
            line-height: 1.8 !important;
            min-height: 400px !important;
            padding: 2rem !important;
            border: 3px solid #ecf0f1 !important;
            border-top: none !important;
            border-radius: 0 0 1rem 1rem !important;
            backdrop-filter: blur(8px) !important;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.2) !important;
        }

        #editor p, #editor h1, #editor h2, #editor h3 {
            color: #ecf0f1 !important;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.5) !important;
        }

        #editor strong {
            color: #f1c40f !important;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7) !important;
            font-weight: 700 !important;
        }

        #editor em {
            color: #e67e22 !important;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5) !important;
        }

        #editor u {
            color: #3498db !important;
            text-decoration-color: #3498db !important;
        }

        .ql-editor.ql-blank::before {
            color: rgba(236, 240, 241, 0.7) !important;
            font-style: italic !important;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3) !important;
        }

        .stats {
            position: fixed;
            bottom: 2rem;
            left: 2rem;
            background: rgba(52, 73, 94, 0.9);
            color: #ecf0f1;
            padding: 1rem 1.5rem;
            border-radius: 1rem;
            font-size: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .save-btn {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 1.5rem 2.5rem;
            border-radius: 2rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.3);
            transition: all 0.3s ease;
            font-family: inherit;
            font-size: 1.1rem;
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.4);
        }

        @media (max-width: 768px) {
            body {
                padding: 1rem;
            }
            
            .header {
                padding: 1rem;
            }
            
            .header-title {
                font-size: 1.5rem;
            }
            
            .content {
                padding: 1.5rem;
            }
            
            .date-input {
                font-size: 2rem;
            }
            
            .title-input {
                font-size: 1.5rem;
            }
            
            #editor {
                font-size: 1.2rem !important;
                min-height: 300px !important;
                padding: 1rem !important;
            }
            
            .stats,
            .save-btn {
                position: relative;
                bottom: auto;
                left: auto;
                right: auto;
                margin: 1rem auto;
                display: block;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="chalkboard-container">
        <div class="header">
            <h1 class="header-title">📝 칠판 알림장 에디터</h1>
            <div class="toolbar">
                <button class="chalk-btn" onclick="saveNotice()">💾 저장하기</button>
                <button class="chalk-btn" onclick="clearAll()">🧽 모두 지우기</button>
                <button class="chalk-btn" onclick="loadSaved()">📂 불러오기</button>
                <button class="chalk-btn" onclick="exportToPDF()">📄 PDF 저장</button>
                <button class="chalk-btn" onclick="useTemplate()">📋 템플릿</button>
                <button class="chalk-btn" onclick="togglePreview()">👁️ 미리보기</button>
            </div>
        </div>
        
        <div class="content">
            <div class="date-section">
                <input type="text" class="date-input" id="dateInput" 
                       placeholder="날짜를 입력하세요..."
                       value="2024년 3월 15일 금요일">
            </div>

            <div class="title-section">
                <input type="text" class="title-input" id="titleInput" 
                       placeholder="제목을 입력하세요..."
                       value="오늘의 알림사항">
            </div>

            <div class="editor-wrapper">
                <!-- Quill 툴바 -->
                <div id="toolbar">
                    <span class="ql-formats">
                        <button class="ql-bold" title="굵게">B</button>
                        <button class="ql-italic" title="기울임">I</button>
                        <button class="ql-underline" title="밑줄">U</button>
                        <button class="ql-strike" title="취소선">S</button>
                    </span>
                    
                    <span class="ql-formats">
                        <select class="ql-color" title="글자색">
                            <option selected></option>
                            <option value="#ecf0f1"></option>
                            <option value="#f1c40f"></option>
                            <option value="#e67e22"></option>
                            <option value="#e74c3c"></option>
                            <option value="#3498db"></option>
                            <option value="#2ecc71"></option>
                            <option value="#9b59b6"></option>
                        </select>
                        
                        <select class="ql-background" title="배경색">
                            <option selected></option>
                            <option value="#f1c40f"></option>
                            <option value="#e67e22"></option>
                            <option value="#e74c3c"></option>
                            <option value="#3498db"></option>
                            <option value="#2ecc71"></option>
                        </select>
                    </span>
                    
                    <span class="ql-formats">
                        <select class="ql-size" title="글자크기">
                            <option value="small">작게</option>
                            <option selected>보통</option>
                            <option value="large">크게</option>
                            <option value="huge">매우크게</option>
                        </select>
                    </span>
                    
                    <span class="ql-formats">
                        <button class="ql-list" value="ordered" title="번호목록">1.</button>
                        <button class="ql-list" value="bullet" title="불릿목록">•</button>
                    </span>
                    
                    <span class="ql-formats">
                        <select class="ql-align" title="정렬">
                            <option selected></option>
                            <option value="center">가운데</option>
                            <option value="right">오른쪽</option>
                        </select>
                    </span>
                    
                    <span class="ql-formats">
                        <button class="ql-clean" title="서식지우기">🧹</button>
                    </span>
                </div>

                <!-- 이모지 팔레트 추가 -->
                <div style="margin-top: 1rem; padding: 1rem; background: rgba(52, 73, 94, 0.8); border-radius: 0.75rem;">
                    <span style="color: #ecf0f1; font-size: 0.9rem; margin-right: 1rem;">빠른 이모지:</span>
                    <button class="emoji-btn" onclick="insertEmoji('😊')" title="웃는 얼굴">😊</button>
                    <button class="emoji-btn" onclick="insertEmoji('👍')" title="좋아요">👍</button>
                    <button class="emoji-btn" onclick="insertEmoji('📚')" title="책">📚</button>
                    <button class="emoji-btn" onclick="insertEmoji('✏️')" title="연필">✏️</button>
                    <button class="emoji-btn" onclick="insertEmoji('🏃‍♂️')" title="운동">🏃‍♂️</button>
                    <button class="emoji-btn" onclick="insertEmoji('🍎')" title="사과">🍎</button>
                    <button class="emoji-btn" onclick="insertEmoji('⭐')" title="별">⭐</button>
                    <button class="emoji-btn" onclick="insertEmoji('💯')" title="100점">💯</button>
                    <button class="emoji-btn" onclick="insertEmoji('🎉')" title="축하">🎉</button>
                    <button class="emoji-btn" onclick="insertEmoji('📝')" title="메모">📝</button>
                </div>

                <!-- Quill 에디터 -->
                <div id="editor">
                    <p>안녕하세요, 학부모님!</p>
                    <p><br></p>
                    <p>오늘의 알림사항을 전달드립니다.</p>
                    <p><br></p>
                    <p>• 내일 체육시간 <strong style="color: #f1c40f;">운동복</strong> 준비해주세요</p>
                    <p>• 수학 문제집 <em style="color: #e67e22;">49-51페이지</em> 풀어오기</p>
                    <p>• 국어 일기 쓰기 (주제: <u style="color: #3498db;">오늘 있었던 일</u>)</p>
                    <p><br></p>
                    <p>감사합니다! 😊</p>
                </div>
            </div>
        </div>
    </div>

    <div class="stats" id="stats">글자 수: 0</div>
    <button class="save-btn" onclick="saveNotice()">💾 저장</button>

    <!-- Quill library -->
    <script src="https://cdn.jsdelivr.net/npm/quill@2/dist/quill.js"></script>

    <script>
        // Quill 에디터 초기화
        const quill = new Quill('#editor', {
            theme: 'snow',
            modules: {
                toolbar: '#toolbar'
            },
            placeholder: '🖍️ 내용을 자유롭게 작성하세요...\n✨ 위의 툴바를 사용해 다양한 서식을 적용해보세요!'
        });

        const titleInput = document.getElementById('titleInput');
        const dateInput = document.getElementById('dateInput');
        const stats = document.getElementById('stats');

        // 글자 수 업데이트
        function updateStats() {
            const title = titleInput.value;
            const content = quill.getText();
            const totalChars = title.length + content.length;
            stats.textContent = `글자 수: ${totalChars.toLocaleString()}`;
        }

        // 저장 기능
        function saveNotice() {
            const noticeData = {
                date: dateInput.value,
                title: titleInput.value,
                content: quill.getContents(), // Delta 형식
                html: quill.root.innerHTML,   // HTML 형식
                text: quill.getText(),        // 텍스트만
                savedAt: new Date().toLocaleString()
            };

            localStorage.setItem('chalkboardNotice', JSON.stringify(noticeData));
            
            // 시각적 피드백
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '✅ 저장완료!';
            btn.style.background = 'linear-gradient(135deg, #2ecc71 0%, #27ae60 100%)';
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = 'linear-gradient(135deg, #3498db 0%, #2980b9 100%)';
            }, 2000);
        }

        // 불러오기 기능
        function loadSaved() {
            const saved = localStorage.getItem('chalkboardNotice');
            if (saved) {
                const data = JSON.parse(saved);
                if (data.date) dateInput.value = data.date;
                if (data.title) titleInput.value = data.title;
                if (data.content) quill.setContents(data.content);
                updateStats();
                alert('📂 저장된 알림장을 불러왔습니다!');
            } else {
                alert('💡 저장된 알림장이 없습니다.');
            }
        }

        // 모두 지우기
        function clearAll() {
            if (confirm('🧽 정말로 모든 내용을 지우시겠습니까?')) {
                dateInput.value = '';
                titleInput.value = '';
                quill.setContents([]);
                updateStats();
            }
        }

        // 이모지 삽입 함수
        function insertEmoji(emoji) {
            const range = quill.getSelection();
            if (range) {
                quill.insertText(range.index, emoji);
            } else {
                quill.insertText(0, emoji);
            }
        }

        // PDF 내보내기 함수 (예시)
        function exportToPDF() {
            alert('📄 PDF 내보내기 기능은 추후 구현 예정입니다!');
        }

        // 템플릿 기능 (예시)
        function useTemplate() {
            const templates = [
                '📚 오늘의 학습 내용: ',
                '✏️ 숙제: ',
                '🏃‍♂️ 준비물: ',
                '📝 특별 안내사항: '
            ];
            
            const template = templates[Math.floor(Math.random() * templates.length)];
            const range = quill.getSelection() || 0;
            quill.insertText(range.index || 0, template);
        }

        // 미리보기 모드
        function togglePreview() {
            const toolbar = document.getElementById('toolbar');
            const controls = document.querySelector('.controls');
            
            if (toolbar.style.display === 'none') {
                toolbar.style.display = 'block';
                controls.style.display = 'block';
                quill.enable();
                alert('✏️ 편집 모드로 전환되었습니다.');
            } else {
                toolbar.style.display = 'none';
                controls.style.display = 'none';
                quill.disable();
                alert('👁️ 미리보기 모드로 전환되었습니다.');
            }
        }

        // 이벤트 리스너
        titleInput.addEventListener('input', updateStats);
        quill.on('text-change', updateStats);

        // 키보드 단축키
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                saveNotice();
            }
        });

        // 초기 글자 수 계산
        updateStats();

        // 자동 저장 (5초마다)
        setInterval(() => {
            if (titleInput.value.trim() || quill.getText().trim()) {
                const autoSaveData = {
                    date: dateInput.value,
                    title: titleInput.value,
                    content: quill.getContents(),
                    autoSavedAt: new Date().toLocaleString()
                };
                localStorage.setItem('chalkboardNoticeAutoSave', JSON.stringify(autoSaveData));
            }
        }, 5000);

        // 페이지 로드 시 자동저장 복원 확인
        window.addEventListener('load', () => {
            const autoSaved = localStorage.getItem('chalkboardNoticeAutoSave');
            if (autoSaved) {
                const data = JSON.parse(autoSaved);
                const isEmpty = !titleInput.value.trim() && !quill.getText().trim();
                
                if (isEmpty && confirm('💾 자동 저장된 내용이 있습니다. 복원하시겠습니까?')) {
                    if (data.date) dateInput.value = data.date;
                    if (data.title) titleInput.value = data.title;
                    if (data.content) quill.setContents(data.content);
                    updateStats();
                }
            }
        });
    </script>
</body>
</html>