# 교사용 알림장 작성 도우미 웹 애플리케이션 - 기능 명세서 (5차 업데이트 - AI 기능 추가)

## 프로젝트 개요
**프로젝트명**: 교사용 알림장 작성 도우미 웹 애플리케이션
**핵심 가치**: 매년, 매번 교사가 알림장 문구를 떠올려 적는 수고로움을 줄이는 것
**주요 목적**: 시간 절약, 일관성 있는 지도, 전문성 향상, AI 기반 맞춤형 문구 생성
**개발 목표**: 1개월 내 프로토타입 완성, 단계별 점진적 개발, AI 기능 단계별 도입

---

## 1. 사용자 요구사항 분석 결과

### 1.1 대상 사용자
- **주요 사용자**: 초/중/고 모든 교사
- **사용 환경**: PC 중심, 온라인 전용
- **핵심 니즈**: 시기에 맞는 알림장 문구 추천 및 다른 교사들이 사용한 문구 공유
- **사용자 경험**: 직관적 사용, 별도 안내 없이도 쉽게 사용 가능

### 1.2 핵심 기능 요구사항
1. **시기별 문구 자동 추천** (현재 날짜 기준)
2. **전체 사용자와 문구 공유** (핵심 기능)
3. **사용자 기여 문구 바로 공개** (신고 시스템 포함)
4. **개인 문구 저장 및 사용 통계**
5. **카테고리 태그 기반 분류**
6. **고급 검색 기능** (태그 기반 필터링 + 자동완성 + 유사 문구 추천)
7. **개선 아이디어 제안 게시판**
8. **🤖 AI 기반 문구 생성 시스템** (신규 핵심 기능)

### 1.3 AI 기능 세부 요구사항 (신규)
1. **날씨·날짜 기반 자동 문구 생성**
   - 현재 날짜와 실시간 날씨 정보를 고려한 맞춤형 문구
   - 중복 방지를 위한 생성 이력 관리
   - 계절별, 날씨별 특화 문구 자동 추천

2. **뉴스 기반 안전 문구 생성**
   - 실시간 뉴스 크롤링을 통한 사회적 이슈 파악
   - 아동 안전 관련 사건사고 자동 감지
   - 해당 이슈에 맞는 예방 문구 자동 생성

3. **교사 요청 기반 맞춤 문구 생성**
   - 자연어 요청을 통한 문구 생성
   - 상황별, 목적별 맞춤 문구 제공
   - 문구 스타일 및 톤앤매너 조절 가능

---

## 2. 화면 구성 및 UI/UX 설계

### 2.1 메인 화면 구성
```
┌─────────────────────────────────────────────────────────────┐
│ [로고] 교사용 알림장 도우미               [로그인] [회원가입] │
├─────────────────────────────────────────────────────────────┤
│ 🔍 검색창: "키워드로 문구 검색"            [🤖 AI 문구 생성] │
├─────────────────────────────────────────────────────────────┤
│ 🤖 오늘의 AI 추천 (2025년 8월 24일, 맑음 28°C)            │
│ [폭염 주의] [야외활동 안전] [수분 섭취] [그늘 이용] ...    │
├─────────────────────────────────────────────────────────────┤
│ 📰 안전 이슈 기반 추천 (최근 뉴스 반영)                    │
│ [아동범죄 예방] [교통사고 주의] [온라인 안전] ...          │
├─────────────────────────────────────────────────────────────┤
│ 📅 오늘 추천 문구 (2025년 8월 기준)                        │
│ [여름철 안전] [방학 중 생활지도] [폭염 주의] ...           │
├─────────────────────────────────────────────────────────────┤
│ 🏷️ 전체 문구 (태그 필터링)                                │
│ [모든 카테고리] [안전지도] [생활지도] [학교폭력예방] ...    │
│                                                             │
│ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐            │
│ │[AI 생성]🤖   │ │[안전지도]    │ │[생활지도]    │            │
│ │오늘 폭염으로 │ │여름철 물놀이 │ │방학 중 규칙적│            │
│ │인한 안전     │ │안전에 주의   │ │생활을...     │            │
│ │- 외출 시 양산│ │- 깊은 물 금지│ │- 일찍 자고   │            │
│ │- 충분한 수분 │ │- 혼자 가지말기│ │- 일찍 일어나기│            │
│ │🤖 AI생성 📋복사│ │❤️ 15 📋 복사 │ │❤️ 8 📋 복사  │            │
│ └─────────────┘ └─────────────┘ └─────────────┘            │
│ └─────────────┘ └─────────────┘ └─────────────┘            │
│                                                             │
│ [더 보기...] [내 문구 추가하기]                            │
└─────────────────────────────────────────────────────────────┘
```

### 2.2 문구 카드 구조
- **카드형 디스플레이**: 전체 텍스트 표시
- **계층적 구조**: 메인 문구 → 하위 세부 문구
- **문구 타입**: 
  - 단일문구: "필요한 사람을 위해 학교 엘리베이터 함부로 이용하지 않기"
  - 복합문구: "오늘 폭우가 예보되어 있어요 - 핸드폰보면서 걷지 않기 - 계단 등 미끄러짐 사고 주의하기"
- **색상 시스템**: 흰색/회색 기반 카드 + 태그별 색상 구분
- **하위 문구 표현**: 사용자가 형식 선택 가능 (들여쓰기, 번호, 불릿포인트 등)
- **인터랙션**: 좋아요, 복사 버튼

### 2.3 문구 편집 화면 (상하 분할 레이아웃)
```
┌─────────────────────────────────────────────────────────────┐
│ 📝 알림장 편집    [메인에서 가져오기] [🎲랜덤추가] [🤖AI포맷팅] [👀미리보기] │
├─────────────────────────────────────────────────────────────┤
│ 📦 선택된 블록들 (0개) - 최대 10개까지 선택 가능             │
│ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐            │
│ │[안전]        │ │[생활지도]    │ │[학습]        │            │
│ │물놀이 안전수칙│ │규칙적인 생활 │ │독서 습관     │            │
│ │여름철 물놀이..│ │방학 중에도.. │ │매일 30분..   │            │
│ └─────────────┘ └─────────────┘ └─────────────┘            │
├─────────────────────────────────────────────────────────────┤
│ ✏️ 편집 영역 (0개)          [🔗병합] [📝포맷팅] [🗑️비우기]   │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 🔄 드래그앤드롭으로 순서 변경 가능                       │ │
│ │                                                         │ │
│ │ ┌─ 블록 1: 여름철 물놀이 안전수칙 ─ [태그] [삭제] ─┐    │ │
│ │ │ 제목: [편집 가능]                                │    │ │
│ │ │ [안전] [여름활동]                               │    │ │
│ │ │ ┌─────────────────────────────────────────────┐ │    │ │
│ │ │ │ 여름철 물놀이 시 다음 안전수칙을..          │ │    │ │
│ │ │ │ - 깊은 물에는 절대 들어가지 마세요         │ │    │ │
│ │ │ │ - 혼자서 물놀이 하지 마세요               │ │    │ │
│ │ │ └─────────────────────────────────────────────┘ │    │ │
│ │ └─────────────────────────────────────────────────┘    │ │
│ │                                                         │ │
│ │ ┌─ 블록 2: 방학 중 규칙적인 생활 ─ [태그] [삭제] ─┐     │ │
│ │ │ ... (드래그 가능한 블록 구조)                    │     │ │
│ │ └─────────────────────────────────────────────────┘     │ │
│ └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 편집 중: 2개     [💾임시저장] [📋클립보드복사] [🌐저장및공유] │
└─────────────────────────────────────────────────────────────┘
```

**주요 특징:**
- **상하 분할**: 선택된 블록(상단) + 편집 영역(하단)
- **블록 중심 편집**: 제목, 내용, 태그별 개별 편집
- **드래그앤드롭**: Sortable.js 기반 순서 변경
- **태그 시스템**: 13개 카테고리, 파스텔 색상 구분
- **자동 날짜 제목**: "2025년 8월 8일 알림장" 자동 생성
- **실시간 카운터**: 선택/편집 중인 블록 개수 표시
- **AI 포맷팅**: 문체 통일(~습니다체, ~해요체 등)
- **새창 미리보기**: 편집 화면 유지하며 별도 탭으로 미리보기

### 2.4 개인 통계 대시보드 화면
```
┌─────────────────────────────────────────────────────────────┐
│ 📊 내 알림장 사용 분석                                      │
├─────────────────────────────────────────────────────────────┤
│ [📝 총 사용 47개] [💾 저장 12개] [🌐 공유 3개] [❤️ 좋아요 28개] │
├─────────────────────────────────────────────────────────────┤
│ 📈 카테고리별 사용 현황 (클릭하면 상세 문구 목록 표시)      │
│ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐            │
│ │ 안전지도     │ │ 생활지도     │ │ 학교폭력예방 │            │
│ │ 18회 (38.3%) │ │ 15회 (31.9%) │ │ 8회 (17.0%) │            │
│ │ ████████░░░░ │ │ ██████░░░░░░ │ │ ███░░░░░░░░░ │            │
│ └─────────────┘ └─────────────┘ └─────────────┘            │
│                                                             │
│ 🕒 최근 활동: 물놀이 안전수칙 사용 (2시간 전)               │
│ 💡 추천: 환경 교육 관련 문구를 사용해보세요                 │
└─────────────────────────────────────────────────────────────┘
```

### 2.5 관리자 대시보드 화면
```
┌─────────────────────────────────────────────────────────────┐
│ ⚡ 관리자 패널                              [데이터 내보내기] │
├─────────────────────────────────────────────────────────────┤
│ [📊 대시보드] [👥 사용자관리] [📄 콘텐츠관리] [💡 피드백관리] │
├─────────────────────────────────────────────────────────────┤
│ 시스템 현황                                                 │
│ [👥 등록교사 1,247명] [📄 전체문구 3,891개]                │
│ [💡 처리대기 47건] [🚨 신고 12건]                          │
│                                                             │
│ 최근 시스템 활동                                           │
│ • 새 교사 가입신청 - 김미영 (서울초등학교) [승인대기]       │
│ • 문구 신고 접수 - 박선생님 [검토중]                       │
│ • 피드백 제출 - 이현수 [처리완료]                          │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. 핵심 기능 상세 명세

### 3.1 문구 편집 시스템 (새로 구현됨)
**블록 중심 편집 구조:**
- **블록 구성**: 제목 + 내용 + 태그 (파스텔 색상 구분)
- **최대 제한**: 10개 블록까지 동시 편집 (성능 고려)
- **편집 범위**: 제목, 내용, 태그 모두 인라인 수정 가능
- **블록 조작**: 
  - 순서 변경: 드래그앤드롭 (Sortable.js 적용)
  - 블록 병합: 같은 태그의 블록들만 자동 병합
  - 블록 분할: 미구현 (단순화 정책)

**AI 포맷팅 기능:**
- **문체 통일**: ~습니다체, ~해요체, ~해체, ~하세요체 선택
- **추가 옵션**: 중복 내용 제거, 문법 검사, 문단 나누기
- **적용 범위**: 편집 영역의 모든 블록 일괄 적용
- **사용자 제어**: 원본과 AI 수정본 비교 후 사용자 선택

**편집 워크플로우:**
1. 메인 화면에서 블록 선택 (토글 방식 장바구니)
2. 편집 페이지 진입 (상하 분할 레이아웃)
3. 상단 블록 카드를 클릭하여 하단 편집 영역에 추가
4. 드래그앤드롭으로 블록 순서 변경
5. 각 블록의 제목/내용/태그 개별 편집
6. AI 포맷팅으로 문체 통일 (선택사항)
7. 새창 미리보기로 최종 결과 확인
8. 클립보드 복사 또는 새 블록으로 공유

**데이터 구조:**
```json
{
  "id": "block_12345",
  "title": "여름철 물놀이 안전수칙",
  "content": "여름철 물놀이 시 다음 안전수칙을...",
  "tags": ["안전", "여름활동"],
  "created_by": "teacher_001",
  "created_at": "2025-08-08T10:30:00Z",
  "is_public": true,
  "report_status": "none",
  "original_block_id": null
}
```

**태그 시스템 (13개 카테고리 + 향후 세분화):**
- **핵심 태그**: 안전, 생활지도, 학습, 건강
- **확장 태그**: 여름활동, 독서, 숙제, 교통, 운동, 환경, 정보통신, 인성, 창의
- **색상 구분**: 안전(빨강), 생활지도(주황), 학습(녹색), 건강(보라)
- **다중 태그**: 하나의 블록에 여러 태그 적용 가능

**향후 세분화 계획** (사용자 피드백 반영):
- **안전 카테고리 세분화**: 교통안전, 여름철 폭염안전, 실내 안전, 물놀이 안전 등
- **생활지도 세분화**: 예절교육, 습관형성, 인성교육 등  
- **학습 세분화**: 독서, 숙제관리, 시험준비 등
- **건강 세분화**: 식습관, 운동, 질병예방 등
- **구현 방식**: Phase 1은 13개 기본 카테고리, Phase 2에서 사용자 데이터 분석 후 세부 카테고리 추가

### 3.2 🤖 AI 기반 문구 생성 시스템 (신규 핵심 기능)

#### 3.2.1 날씨·날짜 기반 자동 문구 생성 (MVP 우선 구현)
**기능 개요:**
- 현재 날짜와 실시간 날씨 정보를 기반으로 맞춤형 문구 자동 생성
- 중복 방지를 위한 생성 이력 관리 및 다양성 확보
- 교사의 수동 입력 없이도 상황에 적합한 문구 제공

**상세 구현 사항:**
```javascript
// AI 문구 생성 요청 데이터 구조
{
  "date": "2025-08-24",
  "weather": {
    "condition": "맑음",
    "temperature": 28,
    "humidity": 65,
    "windSpeed": 2.1,
    "uvIndex": 8
  },
  "context": {
    "season": "여름",
    "schoolPeriod": "방학중",
    "dayOfWeek": "토요일",
    "specialEvents": ["폭염특보"]
  },
  "previousGenerated": ["block_id_1", "block_id_2"] // 중복 방지용
}
```

**생성 로직:**
1. **날씨 데이터 수집**: OpenWeatherMap API 연동
2. **상황 분석**: 날씨 + 날짜 + 계절 종합 분석
3. **문구 생성**: OpenAI GPT-4 API로 맞춤형 문구 생성
4. **중복 확인**: 최근 30일 생성 이력과 비교
5. **자동 태그**: 내용 기반 자동 카테고리 분류

**생성 예시:**
- **폭염일 (28°C+)**: "오늘 기온이 매우 높습니다. 외출 시 양산 사용하기, 충분한 수분 섭취하기"
- **비오는 날**: "우천으로 인한 미끄러짐 사고 주의하기, 우산 사용 시 다른 사람 배려하기"
- **미세먼지 나쁨**: "미세먼지 농도가 높습니다. 실외 활동 자제하기, 마스크 착용하기"

#### 3.2.2 뉴스 기반 안전 문구 생성
**기능 개요:**
- 실시간 뉴스 크롤링을 통한 사회적 안전 이슈 감지
- 아동 안전 관련 사건사고 자동 분석 및 예방 문구 생성
- 시의성 있는 안전 교육 메시지 제공

**크롤링 대상:**
- 주요 뉴스 사이트 (연합뉴스, KBS, MBC, SBS 등)
- 키워드: "아동", "학교", "안전사고", "범죄", "교통사고"
- 업데이트 주기: 매일 2회 (오전 6시, 오후 6시)

**생성 프로세스:**
1. **뉴스 수집**: 웹 크롤링으로 최신 뉴스 수집
2. **키워드 분석**: NLP로 안전 관련 키워드 추출
3. **위험도 평가**: 사건의 심각성 및 빈도 분석
4. **문구 생성**: 해당 이슈 예방을 위한 교육 문구 생성
5. **검증 및 필터링**: 부적절한 내용 자동 필터링

**생성 예시:**
- **아동범죄 증가**: "최근 아동 대상 범죄가 증가하고 있습니다. 모르는 사람 따라가지 않기, 위험 상황 시 큰 소리로 도움 요청하기"
- **교통사고 빈발**: "어린이 교통사고가 잇따르고 있습니다. 횡단보도에서 좌우 확인하기, 신호등 반드시 지키기"

#### 3.2.3 교사 요청 기반 맞춤 문구 생성
**기능 개요:**
- 교사가 자연어로 요청하는 상황별 맞춤 문구 생성
- 다양한 교육 목적과 상황에 맞는 톤앤매너 조절
- 대화형 인터페이스로 즉석 문구 생성

**요청 인터페이스:**
```
교사 입력 예시:
"내일 체육대회가 있는데 안전 관련 문구 만들어줘"
"시험 기간 중 스트레스 관리 문구 필요해"
"학부모 상담 주간 안내 문구 생성해줘"
```

**맞춤 옵션:**
- **톤앤매너**: 친근한 / 공식적인 / 유머러스한 / 진지한
- **대상 연령**: 초등 저학년 / 고학년 / 중학생 / 고등학생
- **문구 길이**: 짧은 (1-2줄) / 보통 (3-4줄) / 상세한 (5줄+)
- **문체**: 존댓말 / 반말 / 높임말

**AI 프롬프트 템플릿:**
```
당신은 경험 많은 교사입니다. 다음 상황에 맞는 알림장 문구를 생성해주세요.

상황: {user_request}
대상: {target_age}학생
톤: {tone}
길이: {length}
문체: {style}

조건:
- 교육적이고 긍정적인 메시지
- 학생이 이해하기 쉬운 언어 사용
- 구체적인 행동 지침 포함
- 안전하고 적절한 내용
```

#### 3.2.4 AI 기능 데이터베이스 구조
```sql
-- AI 생성 문구 테이블
ai_generated_blocks (
  id: UUID PRIMARY KEY,
  generated_by: VARCHAR(50), -- 'weather', 'news', 'custom'
  prompt_data: JSONB, -- 생성 시 사용된 데이터
  generated_content: TEXT,
  tags: TEXT[],
  confidence_score: FLOAT, -- AI 생성 신뢰도
  user_rating: INTEGER, -- 사용자 평가 (1-5)
  usage_count: INTEGER DEFAULT 0,
  created_at: TIMESTAMP,
  is_approved: BOOLEAN DEFAULT true
);

-- 날씨 데이터 캐시 테이블
weather_cache (
  id: UUID PRIMARY KEY,
  date: DATE,
  location: VARCHAR(100),
  weather_data: JSONB,
  fetched_at: TIMESTAMP,
  INDEX(date, location)
);

-- 뉴스 데이터 테이블
news_analysis (
  id: UUID PRIMARY KEY,
  news_url: VARCHAR(500),
  headline: TEXT,
  content: TEXT,
  keywords: TEXT[],
  safety_relevance: FLOAT, -- 안전 관련도 점수
  processed_at: TIMESTAMP,
  generated_blocks: UUID[] -- 생성된 블록 ID들
);

-- AI 생성 히스토리 (중복 방지용)
ai_generation_history (
  id: UUID PRIMARY KEY,
  user_id: UUID,
  generation_type: VARCHAR(20),
  input_hash: VARCHAR(64), -- 입력 데이터 해시
  generated_block_id: UUID,
  created_at: TIMESTAMP,
  INDEX(user_id, generation_type, created_at)
);
```

#### 3.2.5 API 엔드포인트 설계
```
-- AI 문구 생성 API
POST /api/ai/generate/weather     - 날씨 기반 문구 생성 (MVP)
POST /api/ai/generate/news        - 뉴스 기반 문구 생성
POST /api/ai/generate/custom      - 맞춤 문구 생성
GET  /api/ai/history             - AI 생성 히스토리
PUT  /api/ai/blocks/:id/rating   - AI 생성 문구 평가

-- 외부 데이터 API
GET  /api/weather/current        - 현재 날씨 정보
GET  /api/news/safety           - 안전 관련 뉴스 요약
POST /api/news/analyze          - 뉴스 분석 및 문구 생성 (관리자)

-- AI 설정 API
GET  /api/ai/settings           - AI 생성 설정 조회
PUT  /api/ai/settings           - AI 생성 설정 변경
```

### 3.2 문구 추천 시스템
**기능**: 현재 날짜 기준 자동 추천
- **계절별 추천**: 봄(3-5월), 여름(6-8월), 가을(9-11월), 겨울(12-2월)
- **월별 특성**: 각 월별 특징적 이벤트/주의사항
- **특별 시기**: 방학, 시험기간, 학교행사 등
- **알고리즘**: 날짜 + 사용자 선호도 + 인기도 조합

### 3.2 문구 데이터베이스 구조
```sql
문구 테이블 (notices):
- id: 문구 고유 ID
- title: 문구 제목
- content: 문구 내용 (메인)
- sub_contents: 하위 문구들 (JSON 배열)
- notice_type: 문구 타입 (single/complex)
- tags: 카테고리 태그들 (JSON 배열)
- season: 계절 (spring/summer/fall/winter)
- months: 적용 월 (JSON 배열)
- special_periods: 특별 시기 (vacation/exam/event 등)
- author_id: 작성자 ID
- created_at: 생성일
- likes_count: 좋아요 수
- usage_count: 사용 횟수
- status: 상태 (active/reported/hidden)
- report_count: 신고 횟수
```

### 3.3 문구 데이터베이스 구조 (업데이트됨)
**블록 기반 데이터 모델:**
```sql
블록 테이블 (blocks):
- id: 블록 고유 ID
- title: 블록 제목
- content: 블록 내용 (개행 문자 포함)
- tags: 카테고리 태그들 (JSON 배열)
- created_by: 작성자 ID
- created_at: 생성일시
- updated_at: 수정일시
- is_public: 공개 여부 (true/false)
- is_edited: 편집 여부 (원본/편집본 구분)
- original_block_id: 원본 블록 ID (편집본인 경우)
- usage_count: 사용 횟수
- likes_count: 좋아요 수
- report_status: 신고 상태 (none/reported/hidden/approved)
- report_count: 신고 횟수

신고 테이블 (reports):
- id: 신고 고유 ID
- block_id: 신고된 블록 ID
- reporter_id: 신고자 ID
- report_type: 신고 유형 (inappropriate_content/inappropriate_tag/other)
- reason: 신고 사유
- created_at: 신고 일시
- status: 처리 상태 (pending/resolved/dismissed)

편집 세션 테이블 (editing_sessions):
- id: 세션 고유 ID
- user_id: 사용자 ID
- selected_blocks: 선택된 블록 ID들 (JSON 배열)
- editing_blocks: 편집 중인 블록들 (JSON 객체)
- auto_title: 자동 생성된 제목
- created_at: 세션 생성일시
- updated_at: 마지막 수정일시
```

### 3.4 초기 블록 데이터 예시 (10개 샘플)
**안전 관련 블록들:**
```json
[
  {
    "title": "여름철 물놀이 안전수칙",
    "content": "여름철 물놀이 시 다음 안전수칙을 반드시 지켜주세요.\n- 깊은 물에는 절대 들어가지 마세요\n- 혼자서 물놀이 하지 마세요\n- 물놀이 전 충분한 준비운동을 하세요\n- 구명조끼를 착용해주세요",
    "tags": ["안전", "여름활동"]
  },
  {
    "title": "식중독 예방 수칙",
    "content": "여름철 식중독을 예방하기 위해 다음 사항을 지켜주세요.\n- 손을 자주 씻기\n- 음식을 충분히 가열하여 먹기\n- 상한 음식은 절대 먹지 않기\n- 냉장보관 철저히 하기",
    "tags": ["안전", "건강"]
  },
  {
    "title": "교통안전 수칙",
    "content": "등하교 및 외출 시 교통안전에 유의해주세요.\n- 횡단보도에서 좌우 확인\n- 신호등 지키기\n- 차도에서 장난치지 않기\n- 자전거 탈 때 헬멧 착용",
    "tags": ["안전", "교통"]
  }
]
```

## 4. API 엔드포인트 설계 (업데이트됨)

### 4.1 블록 관리 API
```
GET  /api/blocks              - 블록 목록 조회 (필터링, 페이징 지원)
POST /api/blocks              - 새 블록 생성
GET  /api/blocks/:id          - 특정 블록 조회
PUT  /api/blocks/:id          - 블록 수정
DELETE /api/blocks/:id        - 블록 삭제
POST /api/blocks/report       - 블록 신고
GET  /api/blocks/popular      - 인기 블록 조회
GET  /api/blocks/recommended  - 추천 블록 조회 (날짜 기반)
```

### 4.2 편집 세션 API
```
POST /api/editing/session     - 새 편집 세션 생성
GET  /api/editing/session/:id - 편집 세션 조회
PUT  /api/editing/session/:id - 편집 세션 업데이트
POST /api/editing/ai-format   - AI 포맷팅 요청
POST /api/editing/merge       - 블록 병합
POST /api/editing/save        - 편집 결과 저장
```

### 4.3 사용자 관리 API
```
POST /api/auth/login          - 사용자 로그인
POST /api/auth/register       - 사용자 회원가입
GET  /api/users/profile       - 사용자 프로필 조회
GET  /api/users/stats         - 사용자 통계 조회
GET  /api/users/blocks        - 사용자가 만든 블록 목록
```

### 4.4 태그 및 검색 API
```
GET  /api/tags                - 사용 가능한 태그 목록
GET  /api/search              - 블록 검색 (키워드, 태그 필터링)
GET  /api/search/suggestions  - 검색어 자동완성
```

### 4.5 신고 및 관리 API
```
POST /api/reports             - 신고 접수
GET  /api/admin/reports       - 신고 목록 조회 (관리자)
PUT  /api/admin/reports/:id   - 신고 처리 (관리자)
PUT  /api/admin/blocks/:id/status - 블록 상태 변경 (관리자)
```

## 5. 기술 구현 세부사항

### 5.1 프론트엔드 기술스택
- **HTML5/CSS3**: 시맨틱 마크업, Flexbox/Grid 레이아웃
- **JavaScript ES6+**: 모듈화, 비동기 처리
- **Sortable.js**: 드래그앤드롭 기능
- **LocalStorage**: 임시저장 기능
- **Fetch API**: 서버 통신

### 5.2 편집 페이지 핵심 구현
**상하 분할 레이아웃:**
```css
.editor-layout {
  display: flex;
  flex-direction: column;
  height: calc(100vh - 160px);
  gap: 20px;
}

.selected-blocks-section {
  min-height: 120px;
  max-height: 200px;
  overflow-y: auto;
}

.editing-section {
  flex: 1;
  display: flex;
  flex-direction: column;
}
```

**드래그앤드롭 구현:**
```javascript
new Sortable(workspace, {
  animation: 150,
  ghostClass: 'drag-placeholder',
  onEnd: function(evt) {
    // 블록 순서 재배열 로직
  }
});
```

**AI 포맷팅 시뮬레이션:**
```javascript
function applyAIFormat(style) {
  editingBlocks.forEach(block => {
    let content = block.content;
    switch(style) {
      case 'formal':
        content = content.replace(/해요\./g, '합니다.');
        break;
      // 기타 문체 변환 로직
    }
    block.content = content;
  });
}
```
1. **개인 블록 저장**: 편집한 블록을 새로운 블록으로 저장
2. **사용 통계 대시보드**: 
   - 카테고리별 사용 빈도 분석 및 시각화
   - 월별 사용 패턴 추이 그래프
   - 최근 활동 내역 타임라인
   - 카테고리별 상세 사용 블록 목록 (클릭 시 모달 표시)
3. **편집 워크플로우 최적화**:
   - 자동 날짜 제목 생성 ("2025년 8월 8일 알림장")
   - 임시저장 기능 (LocalStorage 활용)
   - 서식 포함 클립보드 복사
   - 새창 미리보기 (편집 화면 유지)
3. **미사용 카테고리 추천**: 아직 다루지 않은 주제 제안으로 카테고리 태그 기반 지원
4. **즐겨찾기**: 자주 사용하는 문구 북마크
5. **개인 문구 관리**: 
   - 저장한 문구 / 작성한 문구 / 공유된 문구 탭별 관리
   - 문구 태그 시스템 및 검색 기능
   - 문구 편집 및 삭제 기능

### 3.6 공유 및 기여 시스템
**문구 공유**:
- 전체 사용자 대상 공개
- 실시간 인기 문구 표시
- 최신 등록 문구 표시

**사용자 기여**:
- 새 문구 바로 공개
- **신고 시스템**: 
  - 신고 즉시 해당 문구 숨김
  - 24시간 내 관리자 검토 후 처리
  - 신고 처리 전까지 해당 계정 문구 비노출

**개선 아이디어 시스템**:
- 사용자 제안 기능 (새 기능, 기능 개선, 콘텐츠 추가, 버그 신고)
- 투표 시스템 (좋아요/싫어요)
- 우선순위 관리 (높음/보통/낮음)
- 상태 추적 (검토 대기/검토 중/완료)
- 카테고리별 필터링 및 정렬 기능

### 3.7 관리자 시스템
**사용자 관리**:
- 교사 계정 승인/거부 시스템
- 사용자 활동 모니터링
- 계정 상태 관리 (활성/대기/차단)

**콘텐츠 관리**:
- 문구 승인/거부/편집/삭제
- 카테고리별 문구 분류 관리
- 사용 통계 및 인기도 분석

**피드백 및 신고 처리**:
- 사용자 제안 검토 및 처리
- 문구 신고 검토 및 조치
- 피드백 상태 업데이트

**시스템 설정**:
- 가입 승인 방식 설정 (수동/자동)
- 일일 사용 제한 설정
- 알림 설정 관리

---

## 4. 기술적 구현 요구사항

### 4.1 확정된 기술 스택
- **Frontend**: Vue.js (SPA)
- **Backend**: Supabase (우선) 또는 Node.js/Express
- **Database**: Supabase PostgreSQL 또는 PostgreSQL
- **인증**: Supabase Auth 또는 JWT 기반 사용자 인증
- **AI Services**: OpenAI GPT-4 API, OpenWeatherMap API
- **뉴스 크롤링**: Puppeteer/Cheerio, 주요 뉴스 API
- **배포**: Vercel/Netlify (프론트엔드) + Supabase (백엔드)

### 4.2 고급 검색 기능 API
```
GET /api/notices/search - 키워드 + 태그 기반 검색
GET /api/notices/autocomplete - 자동완성 키워드
GET /api/notices/similar/:id - 유사 문구 추천
GET /api/notices/recommended - 오늘 추천 문구
POST /api/notices - 새 문구 등록
PUT /api/notices/:id/like - 문구 좋아요
POST /api/notices/:id/copy - 문구 사용 카운트
GET /api/users/stats - 개인 사용 통계
GET /api/users/stats/category/:category - 카테고리별 사용 문구 목록
POST /api/reports - 문구 신고
GET /api/feedback - 개선 아이디어 게시판
POST /api/feedback - 새 개선 아이디어 제출
PUT /api/feedback/:id/vote - 아이디어 투표
GET /api/admin/users - 사용자 목록 (관리자)
PUT /api/admin/users/:id/approve - 사용자 승인 (관리자)
GET /api/admin/dashboard - 관리자 대시보드 통계
POST /api/notices/edit - 문구 편집 페이지용 조합 저장
```

### 4.3 데이터 구축 전략
- **초기 문구**: 직접 작성 + 최소한만 준비
- **사용자 기여**: 바로 공개로 빠른 데이터 확장
- **품질 관리**: 신고 시스템으로 품질 유지
- **AI 확장성**: 향후 AI 기반 문구 스타일 통일 기능 고려

---

## 5. 개발 계획 및 우선순위

### 5.1 Phase 1 (1개월 내 MVP) - **AI 기능 우선 구현**
1. **기본 UI 구성**: Vue.js 기반 카드형 문구 표시
2. **Supabase 연동**: 기본 CRUD 기능
3. **🤖 날씨 기반 AI 문구 생성**: OpenWeatherMap + OpenAI API 연동 (MVP 우선)
4. **초기 데이터**: 직접 작성한 20-30개 문구 + AI 생성 문구
5. **문구 편집 기능**: 선택된 문구 조합 및 편집
5. **개인 문구 관리**: 저장/작성/공유 문구 탭별 관리
6. **기본 통계**: 개인 사용 패턴 분석
7. **문구 검색**: 키워드 + 태그 필터링
8. **사용자 인증**: 기본 회원가입/로그인 (교사 승인 시스템 포함)

### 5.2 Phase 2 (베타 버전) - **AI 기능 확장**
1. **📰 뉴스 기반 AI 문구 생성**: 웹 크롤링 + AI 분석으로 시의성 있는 안전 문구
2. **🎯 맞춤형 AI 문구 생성**: 교사 요청 기반 대화형 문구 생성
3. **사용자 기여 기능**: 문구 등록/공유
4. **고급 개인화 기능**: 상세 통계, 카테고리별 분석, 즐겨찾기
5. **관리자 도구**: 사용자 승인, 콘텐츠 관리, 신고 처리
6. **AI 품질 관리**: 생성 문구 평가 시스템, 사용자 피드백 반영

### 5.3 Phase 3 (정식 서비스) - **AI 고도화 및 최적화**
1. **AI 학습 모델 개선**: 사용자 피드백 기반 문구 품질 향상
2. **성능 최적화**: 대용량 데이터 처리, AI 응답 속도 개선
3. **고급 검색**: 자동완성, 유사 문구 추천, AI 기반 의미 검색
4. **고도화된 관리자 기능**: AI 생성 통계, 시스템 설정, 품질 모니터링
5. **신고 시스템**: 부적절한 문구 관리 (AI 기반 자동 필터링 포함)
6. **피드백 시스템**: 개선 아이디어 제안 및 투표

### 5.4 향후 확장 계획
1. **AI 모델 자체 학습**: OpenAI 대신 자체 교육 문구 생성 모델 개발
2. **다국어 지원**: 영어, 중국어 등 다국어 문구 생성
3. **음성 인식**: 교사 음성 요청으로 문구 생성
4. **모바일 앱**: 네이티브 앱으로 확장
5. **학교 시스템 연동**: 기존 학교 관리 시스템과 API 연동
6. **실시간 협업**: 여러 교사가 함께 문구 편집

---

## 6. 성공 지표 (KPI)

- **사용자 수**: 월 활성 사용자 1,000명
- **문구 사용률**: 등록된 문구의 70% 이상 최소 1회 사용
- **사용자 기여도**: 전체 문구 중 사용자 기여 문구 30% 이상
- **만족도**: 사용자 설문 4.0/5.0 이상
- **효율성**: 기존 대비 알림장 작성 시간 50% 단축

---

## 7. 프로토타입 구현 현황

### 7.1 완료된 기능

#### 블록 기반 편집 시스템 (edit-notice.html)
- **기능**: 제목, 내용, 태그로 구성된 블록 단위 편집
- **구현**: 완료 ✅
- **특징**: 
  - 드래그 앤 드롭으로 블록 순서 변경
  - 개별 블록 편집 모드 전환
  - 블록 추가/삭제 기능
  - 13가지 카테고리 태그 시스템

#### 고도화된 미리보기 시스템 (NoticePreview.vue)
- **기능**: 편집된 알림장의 실시간 미리보기 및 출력 제어
- **구현**: 완료 ✅
- **주요 특징**:
  - **요소 표시/숨김 제어**: 헤더, 항목 번호, 개별 내용 표시 여부 선택
  - **새창 미리보기**: 편집 화면과 독립된 미리보기 창
  - **줌 컨트롤**: 50%~300% 확대/축소 기능
  - **키보드 단축키**: Ctrl+/- (줌), Ctrl+0 (초기화)
  - **프린트 최적화**: 프린트 시 불필요 요소 자동 숨김
  - **반응형 디자인**: 모바일/태블릿/데스크톱 최적화

#### 코드 아키텍처 개선
- **기능**: 코드 모듈화 및 재사용성 향상
- **구현**: 완료 ✅
- **개선 사항**:
  - **유틸리티 분리**: previewWindow.ts로 미리보기 로직 분리
  - **타입 안전성**: PreviewOptions 인터페이스 정의
  - **코드 최적화**: NoticePreview.vue 26% 코드 감소 (881줄 → 653줄)
  - **재사용성**: 미리보기 기능을 다른 컴포넌트에서도 활용 가능

#### AI 문구 정리 기능
- **기능**: 선택된 블록들의 문구 스타일 통일
- **구현**: UI 완료 ✅ (API 연동 대기)
- **특징**:
  - 형식 통일, 높임말 통일, 문체 일관성 옵션
  - 실시간 미리보기 (시뮬레이션)
  - 정리 전후 비교 기능

#### 상하 분할 레이아웃
- **기능**: 편집 영역과 미리보기 영역 분리
- **구현**: 완료 ✅
- **특징**:
  - 상단: 블록 편집 영역 (드래그 앤 드롭)
  - 하단: 최종 알림장 미리보기
  - 새 탭으로 미리보기 열기 기능

#### 태그 시스템
- **기능**: 13개 카테고리별 색상 구분
- **구현**: 완료 ✅
- **카테고리**: 안전(빨강), 생활지도(주황), 학습(초록), 건강(보라), 행사(파랑), 알림(노랑), 상담(분홍), 칭찬(연두), 주의(빨강), 준비물(갈색), 숙제(회색), 기타(검정), 일반(기본)

### 7.2 구현된 데이터 구조

```javascript
// 블록 데이터 모델
{
  id: "unique_id",
  title: "블록 제목",
  content: "상세 내용",
  tags: ["카테고리1", "카테고리2"],
  order: 1
}
```

### 7.3 테스트 환경
- **더미 데이터**: 10개 샘플 블록 포함
- **기능 테스트**: 모든 핵심 기능 동작 확인
- **브라우저 호환성**: 모던 브라우저 지원

### 7.4 다음 개발 단계

#### 즉시 구현 필요
1. **Supabase 연동**: 블록 데이터 저장/불러오기
2. **AI API 연동**: OpenAI 또는 Claude API 통합
3. **사용자 인증**: 개인별 데이터 관리

#### 단기 목표 (1-2주)
1. **백엔드 구축**: 데이터베이스 스키마 구현
2. **API 엔드포인트**: CRUD 기능 완성
3. **통계 페이지**: stats.html과 연동

#### 중기 목표 (1-2개월)
1. **문구 라이브러리**: 공유 문구 시스템
2. **검색 기능**: 문구 검색 및 필터링
3. **사용자 기여**: 문구 등록 및 승인 시스템

---

## 8. 최신 구현 현황 (2025.08.14 업데이트)

### 8.1 Vue 3 TypeScript 기반 구조
- **프레임워크**: Vue 3 + TypeScript + Vite
- **상태 관리**: Composition API 기반
- **라우팅**: Vue Router 4
- **스타일링**: Tailwind CSS + PostCSS

### 8.2 핵심 컴포넌트 구조
```
src/
├── components/
│   ├── NoticePreview.vue (653줄, 미리보기 + 제어)
│   └── ...기타 컴포넌트
├── utils/
│   └── previewWindow.ts (새창 미리보기 유틸리티)
├── router/
└── stores/
```

### 8.3 기술적 특징
- **모듈화**: 복잡한 로직을 유틸리티로 분리
- **타입 안전성**: TypeScript 인터페이스 활용
- **반응형**: 완전한 모바일/데스크톱 지원
- **접근성**: 키보드 단축키 및 스크린 리더 지원

### 8.4 성능 최적화
- **코드 분할**: 유틸리티 함수 분리로 번들 크기 최적화
- **메모리 효율**: 불필요한 DOM 조작 최소화
- **사용자 경험**: 실시간 미리보기 + 독립 창 지원

---

이 기능 명세서를 바탕으로 개발을 시작할 준비가 되었습니다!
